
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>vimtaku blog</title>
	<meta name="author" content="vimtaku">

	
	<meta name="description" content="TL;DR 1
2
defaults write -g InitialKeyRepeat -int 9
defaults write -g KeyRepeat -int 2 背景
Mac OS Sierra にしてから karabiner elements になって、 &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="vimtaku blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="http://vimtakublog.qolwu.com/favicon.ico" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">vimtaku blog</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:vimtaku.github.io">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/vimtaku" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/vimtaku" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:vimtaku.github.io">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2017/01/29/keyrepeat/">
		
			Mac OS Sierra で Karabiner-elements がない場合に Keyrepeat を早く適切にする方法</a>
	</h2>
	<div class="entry-content">
		<h2 id="tldr">TL;DR</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">defaults write -g InitialKeyRepeat -int 9
</span><span class="line">defaults write -g KeyRepeat -int 2</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section">背景</h2>
<p>Mac OS Sierra にしてから karabiner elements になって、キーリピートの設定ができなくなった。
mac の system preferences からできる最速ではもちろん物足りないので、一旦目安としての数値がなかったので記述する。</p>

<h2 id="section-1">概要</h2>
<p>iterm から</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">defaults write -g InitialKeyRepeat -int 9
</span><span class="line">defaults write -g KeyRepeat -int 2</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>の各コマンドを実行して再起動したら反映された。若干はやいきもするが、慣れの問題かと思っている。</p>

<h2 id="section-2">所感</h2>
<p>最初1,1 とかにしたら大変なことになったので、誰かのためになればさいわいです。</p>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2017-01-29T11:15:34+09:00" pubdate data-updated="true">Jan 29<span>th</span>, 2017</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/karabiner/'>karabiner</a>, <a class='category' href='/blog/categories/karabiner-elements/'>karabiner-elements</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2016/09/18/au_mineo_iphonese/">
		
			iPhone6 + au(誰でも割+LTEフラット) 運用を、 iPhoneSE と格安SIM(mineo Dプラン) の運用にする</a>
	</h2>
	<div class="entry-content">
		<h2 id="tldr">TL;DR</h2>
<ul>
  <li>iPhone6 を iPhoneSE に変更(大体30分)
    <ul>
      <li>約3万</li>
      <li>アップルストアで30分(バックアップ戻す時間込み)</li>
    </ul>
  </li>
  <li>2016年11月1日(あたり)に mineo Dプランを、エントリーパッケージ経由で契約する
    <ul>
      <li>その後自動でau が解約される(解約更新月なので9800円くらいがかからない)。</li>
      <li>au は月末解約扱いになるらしいが、システムの対応が間に合ってないせいでまだそうなってないっぽい。</li>
    </ul>
  </li>
</ul>

<h2 id="section">背景</h2>
<p>iPhone6 が日本にて発売されたのが 2014年9月で、おそらくそのときに購入した。<br />
その流れで、 au の「誰でも割」「LTEフラット」を契約して、約2年間運用してきた。<br />
そもそもパケットの料金が高すぎるので不満をいだいて居たので、<br />
格安シムのほうが安くなるのはおそらく確実だろうということで、<br />
どのようにすればよいか調べたのでココに記しておく。  </p>

<h3 id="section-1">自分の要求</h3>
<ul>
  <li>もちろん速度が出ると良い。  </li>
  <li>テザリングは必須。  </li>
  <li>電話はあまりしない。(するときは実家になど、たまに長くなるとお金がかかる)  </li>
  <li>大体実績値がパケット使用量 7GB/月 程度。もうちょっとあっていいと思っている。  </li>
</ul>

<h2 id="section-2">概要</h2>
<ul>
  <li>端末を何にすればよいか?  </li>
  <li>MVNO をどこにすればよいか？  </li>
  <li>au の契約更新月について  </li>
</ul>

<h2 id="section-3">端末を何にすればよいか?</h2>
<p>iPhoneSE とした。<br />
iPhone7 発売に伴い, iPhoneSE 64GB が 49800円(税別)なので、これにした。<br />
iPhone7 は、今の自分には必要ないと思ったからだ。  </p>

<p>Android はOS的に好きでないのでやめた。  </p>

<p>銀座アップルストアに行って、iPhone6 が24,000円で下どってくれたので、実質3万くらいで購入できた。<br />
mac の iTunes でフルバックアップを取って行かないと無駄足になるので注意。  </p>

<h2 id="mvno-">MVNO をどこにすればよいか？</h2>
<p>mineo にした。<br />
iPhoneSE でのテザリングでの前提だと IIJmio と mineo が良いらしい。<br />
<a href="http://cospahack.com/life/iphone-se-sim">出典はこちら。</a><br />
自分は、ちょっとググッた結果通信速度の安定的に mineo のほうが良さそうだと判断したのと、<br />
通信料を最大2GBシェアリングできる概念みたいなものがあるようなので、こちらにした。  </p>

<p>自分が調べた結果だと、Y!mobile とか UQ mobile とかはテザリングNG だったりする。<br />
テザリング使いたい人は前提をテザリングに考えたほうが良いと思う。  </p>

<h2 id="au-">au の契約更新月について</h2>
<p>au の契約更新月は、誰でも割とかだと 25ヶ月、26ヶ月目くらいらしい。<br />
au の人なら多分入れているであろう、auお客様サポートアプリの「ご契約情報」 「料金割引サービス」に、  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">誰でも割
</span><span class="line">(次回更新年月 2016年11月~2016年12月)</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>などと書いてあるのが確認できるのでご確認を。  </p>

<p>ちなみに、解約についてであるが、au は月末解約扱いになると宣言しているが、<br />
システムの対応が間に合ってないせいでまだそうなってないっぽい。  </p>

<h2 id="mineo-">mineo にするならこれを買うと安くなる模様。</h2>
<p>普通にmineo公式サイトを見ればわかるけど、プロモコードを入れるところがある。<br />
申し込み時の方法が主に3つあるけど、下記を購入して登録すると、新規登録手数料がおよそ 2000円安くなるらしいので、<br />
これを買ったらイイんじゃないかなと思う。  </p>

<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="//rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=vimtaku-22&amp;o=9&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=B00UT26M0Q&amp;linkId=727145ea31131a6c5654ff0141c682df"></iframe>

<h2 id="section-4">お得感見積もり</h2>

<h3 id="before">BEFORE</h3>
<p>auのもろもろ(7GB制限):月平均1万円</p>

<h3 id="after">AFTER</h3>
<p>10GB(音声+データSIM): 3220円<br />
通話料大体:400~600円<br />
4000円くらい  </p>

<p>月6000円お得。電話の具合によってはもうちょっとお得具合がへるがそれでも月6000円はでかい気がする。  </p>

<p>3万の端末代金は 6000 * 5ヶ月あればもとが取れる予定。  </p>

<h2 id="section-5">所感</h2>
<p>大体3時間くらいいろいろ調べた結果なので、誰かのために慣れば幸いです。  </p>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-09-18T12:02:17+09:00" pubdate data-updated="true">Sep 18<span>th</span>, 2016</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/iphone/'>iPhone</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2016/08/05/ridgepole-version-index-error/">
		
			Ridgepole Command Gets [ERROR] Undefined Method Index</a>
	</h2>
	<div class="entry-content">
		<h2 id="tldl">TL;DL</h2>
<p>You should use newest version of gem definetly.</p>

<h2 id="i-faced-this-error">I faced this error</h2>
<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">[ERROR] undefined method `index' for #&lt;Ridgepole::DSLParser::Context::TableDefinition:0x007fae9aa1b850&gt;</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="solved">Solved</h2>
<p>This is version problem.</p>

<p>I simply write as follows,</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">gem 'ridgepole'</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>but it seems downloads version is 0.5.0.</p>

<p>I finally found 0.6.4 is newest ver for now, so I used it, problem disappeared.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-08-05T16:53:16+09:00" pubdate data-updated="true">Aug 5<span>th</span>, 2016</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2016/05/03/lets-encrypt/">
		
			Let&#8217;s Encrypt で Ec2 で単独で動いているサービスを Https 化する</a>
	</h2>
	<div class="entry-content">
		<h2 id="section">はじめに</h2>
<p>前提として、 EC2 に passanger + nginx でサービスを動かしている。<br />
Let’s encrypt を導入するには主に以下をやる必要があるだろう。</p>

<ol>
  <li>サーバにログインして letsencrypt-auto スクリプトを使用して証明書を作成</li>
  <li>nginx に設定し、再起動</li>
  <li>90日で切れるので、証明書の自動更新をつける</li>
</ol>

<p>以下では、<br />
 - force SSL 的な設定は今のところ nginx などではやらない。<br />
 - クライアント側のアプリなどで対応する。  </p>

<h2 id="section-1">1. 証明書を作成</h2>
<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class=""><span class="line">cd /opt
</span><span class="line">git clone https://github.com/letsencrypt/letsencrypt
</span><span class="line">cd /opt/letsencrypt
</span><span class="line"># ec2 のセキュリティグループで 443 を開けておく
</span><span class="line">./letsencrypt-auto certonly --standalone</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="nginx-">2. nginx に設定し、再起動</h2>

<p>以下をいい感じに追加する。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class=""><span class="line">   listen 443 ssl;
</span><span class="line">
</span><span class="line">   ssl_certificate /etc/letsencrypt/live/your.domain.name/fullchain.pem;
</span><span class="line">   ssl_certificate_key /etc/letsencrypt/live/your.domain.name/privkey.pem;
</span><span class="line">   ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
</span><span class="line">   ssl_prefer_server_ciphers on;
</span><span class="line">   ssl_ciphers 'EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH';</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-2">3. 自動更新</h2>

<p>su で crontab -e</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">00 05 01 * * /etc/init.d/nginx stop; /opt/letsencrypt/letsencrypt-auto certonly --standalone -d your.domain.name --renew-by-default --debug ; /etc/init.d/nginx start;</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-3">所感</h2>
<p>https 化が簡単にできて最高な時代だなぁと思った。</p>

<h2 id="section-4">参考</h2>
<p><a href="https://www.mitchcanter.com/lets-encrypt-ssl-amazon-aws/">https://www.mitchcanter.com/lets-encrypt-ssl-amazon-aws/</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-05-03T16:19:17+09:00" pubdate data-updated="true">May 3<span>rd</span>, 2016</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/lets-encrypt/'>lets_encrypt</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2016/03/05/headphone-sennheiser-hd25-amperior/">
		
			俺が考える最強ヘッドフォンゼンハイザーHD25-1 Ⅱ を超えた Amperior With リケーブル</a>
	</h2>
	<div class="entry-content">
		<h2 id="section">はじめに</h2>

<p><a href="http://vimtaku.github.io/blog/2014/08/17/headphone-sennheiser-best/">過去の記事</a>で書いたとおり、ゼンハイザーHD25-1 は俺が考える最強ヘッドフォンだった。<br />
しかし、 Amperior はさらにそれを超えている。しかも現在では Amazon だと HD25-1 より安い。<br />
本記事ではこのヘッドフォンについてレビューをする。  </p>

<h2 id="section-1">いまのベストを書く</h2>

<ul>
  <li>
    <p>2万5千円あるならこれを買おう。
<a href="http://www.amazon.co.jp/gp/product/B009QV14MC/ref=as_li_ss_il?ie=UTF8&amp;camp=247&amp;creative=7399&amp;creativeASIN=B009QV14MC&amp;linkCode=as2&amp;tag=vimtaku-22"><img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=B009QV14MC&amp;Format=_SL110_&amp;ID=AsinImage&amp;MarketPlace=JP&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=vimtaku-22" /></a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=vimtaku-22&amp;l=as2&amp;o=9&amp;a=B009QV14MC" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></p>
  </li>
  <li>
    <p>リケーブルはこれ。
<a href="http://hb.afl.rakuten.co.jp/hgc/14c7dd20.11028942.14c7dd22.8f5ec1f7/?pc=http%3a%2f%2fitem.rakuten.co.jp%2fneowing-r%2fneoacs-55378%2f%3fscid%3daf_link_txt&amp;m=http%3a%2f%2fm.rakuten.co.jp%2fneowing-r%2fn%2fneoacs-55378" target="_blank">FURUTECH(フルテック) / ADL ヘッドホンリケーブル SENNHEISER HD25-1 / HD25-1 II向け（ケーブルの長さ1.3M） iHP-35S HD25 1.3m[グッズ]</a></p>
  </li>
</ul>

<p>これらで至高の環境が手に入る。  </p>

<h2 id="section-2">詳細</h2>

<h3 id="amperior-">Amperior について</h3>
<p>HD25-1 と比べてずっしりとした重さをかんじるが、別に装着してて疲れるわけではない。<br />
HD25-1 とくらべて、音質が一つづつクリアになっているように感じる。<br />
HD25-1 の音のでかたや音圧は、初めてした時は圧倒的に感じるが、Amperior とくらべてしまうと<br />
どこかぼやっとしてしまうように思う。<br />
Amperior は音圧もすごく、特にロックのサビなどにおけるベースラインのクリアさは驚きがある。<br />
中高音はやはり得意な領域で、低音もやはり得意だろうと思う。<br />
ドラムのシンバルのような音や、シャリッとした音は少し弱めに思うだろう。<br />
それにしても、全体的にクリアで、ゼンハイザーが好きな人なら絶対満足するだろう。  </p>

<p>イヤーパッドはベロアで、しかもしっかりとしていて良い。<br />
HD25-1 とくらべて締りはそんなに強くないと思う。  </p>

<h3 id="section-3">リケーブルについて</h3>
<p>純正のケーブルは、数ヶ月で断線する。<br />
HD25-1 を使っている方はもうおなじみだと思うが、これは確実に起こるだろう。<br />
普通に生きていてこうなるのだ。もう諦めよう。<br />
ただ、そのたびに新しいリケーブルを試せる。<br />
前回までイイと思ってたやつがあったんだけど、今回のリケーブルはそれを超えてきた。  </p>

<p>基本的にはギターが得意なケーブルだと思う。HD25-1 にしばらくさして聞いていたが、<br />
シールド?コネクタ部もとてもぶっとくて断線しにくそうだし、かなりクリアに中高音が聞こえる。<br />
これからどれくらい持つかで評価が変わると思うが、長持ちするならこれは素晴らしい。<br />
まぁ値段も普通に 8000円とかするからそうじゃなきゃこまるんだけど。</p>

<p>ちなみにリケーブルは、もともとのケーブルと クランプ部分が別途が接着してるので、こういうのが必要らしい、約1000円。<br />
<a href="http://hb.afl.rakuten.co.jp/hgc/14c806de.4979485e.14c806df.b0d67e71/?pc=http%3a%2f%2fitem.rakuten.co.jp%2fe-earphone%2f4012418444334%2f%3fscid%3daf_link_txt&amp;m=http%3a%2f%2fm.rakuten.co.jp%2fe-earphone%2fn%2f4012418444334" target="_blank">SENNHEISER(ゼンハイザー) ケーブルクランプセット Cable Clamp Set For HD25【044433】</a></p>

<p>しかも、このクランプのネジが精密ネジとからしく、この特殊ドライバーの H6 っていうやつを使う必要があった、約2000円。<br />
<a href="http://www.amazon.co.jp/gp/product/B002HVMFRG/ref=as_li_ss_tl?ie=UTF8&amp;camp=247&amp;creative=7399&amp;creativeASIN=B002HVMFRG&amp;linkCode=as2&amp;tag=vimtaku-22">アネックス(ANEX) スーパーフィット精密両頭差替ヘクスローブドライバービット3本組セット ケース付 No.3602</a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=vimtaku-22&amp;l=as2&amp;o=9&amp;a=B002HVMFRG" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></p>

<h2 id="section-4">所感</h2>
<p>ゼンハイザーの MOMENTUM シリーズとかも、便利だし音もいい感じなんだけど、<br />
結局 HD25-1 の方が良いと思った。<br />
それよりも素晴らしい Amperior は、本当にいいヘッドフォンだと思う。<br />
みんな買えばいいんじゃないかな、損はしないと、俺は言い切れるよ。  </p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-03-05T16:53:16+09:00" pubdate data-updated="true">Mar 5<span>th</span>, 2016</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/headphone/'>headphone</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/12/09/utf8mb4/">
		
			Rails4 で Utf8mb4 にしたい話</a>
	</h2>
	<div class="entry-content">
		<p>自分用のメモ</p>

<h2 id="etcmycnf">/etc/my.cnf</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class=""><span class="line">[client]
</span><span class="line">default-character-set=utf8mb4
</span><span class="line">
</span><span class="line">[mysqld]
</span><span class="line">character-set-server=utf8mb4
</span><span class="line">innodb_file_per_table
</span><span class="line">innodb_file_format=barracuda
</span><span class="line">innodb_large_prefix = 1</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="railsrootconfigdatabaseyml">$RAILS_ROOT/config/database.yml</h2>
<p>default に追加</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class=""><span class="line">charset: utf8mb4
</span><span class="line">encoding: utf8mb4
</span><span class="line">collation: utf8mb4_general_ci</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="ridgepole--schemafile">ridgepole の Schemafile</h2>
<p>create_table :news, force: true, id: :bigint, options: “ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 ROW_FORMAT=DYNAMIC” do |t|
    blahblah…
end</p>

<h2 id="section">参考</h2>
<p><a href="http://blog.arith-metic.jp/category/rails">http://blog.arith-metic.jp/category/rails</a>
<a href="http://yamacent.hatenablog.com/entry/2015/06/06/235900">http://yamacent.hatenablog.com/entry/2015/06/06/235900</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-12-09T00:00:00+09:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rails/'>rails</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/11/08/rails-url-helper/">
		
			I Wanna Test View *_path on My Rails Console(pry), So What Should I Do?</a>
	</h2>
	<div class="entry-content">
		<h2 id="just-do">Just do</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class=""><span class="line">pry(main)&gt; include Rails.application.routes.url_helpers
</span><span class="line">
</span><span class="line">pry(main)&gt; admin_customer_path(User.first)
</span><span class="line">User Load (0.3ms)  SELECT  `users`.* FROM `users`  ORDER BY `users`.`id` ASC LIMIT 1
</span><span class="line">=&gt; "/admin/customers/1"</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>enjoy!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-11-08T13:04:14+09:00" pubdate data-updated="true">Nov 8<span>th</span>, 2015</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rails/'>rails</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/11/08/activerecord_transaction_rescue/">
		
			If You Use ActiveRecord::Base.transaction Syntax, You Shoud Surround It Begin Rescue Clauses</a>
	</h2>
	<div class="entry-content">
		<h1 id="tldr">TL;DR</h1>
<p>If you use ActiveRecord::Base.transaction syntax, you shoud surround it begin rescue clauses.</p>

<h1 id="detail">Detail</h1>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class=""><span class="line">class Hoge
</span><span class="line">  def self.exec
</span><span class="line">    raise "something is not good" if something_check
</span><span class="line">
</span><span class="line">    ActiveRecord::Base.transaction do
</span><span class="line">      User.create(username:"moge")
</span><span class="line">      User.create(username:"moge")
</span><span class="line">    end
</span><span class="line">
</span><span class="line">    rescue StandardError =&gt; e
</span><span class="line">      # if database transaction has occured, this statements will be called
</span><span class="line">      p "duplicate error"
</span><span class="line">  end</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>This code looks good, but includes terrible problem.
It’s definetly rescue clause. In this code, something_check return true, raise “something is not good” error,<br />
<code>and shows "duplicate error"</code>. Terrible.</p>

<p>so if you use ActiveRecord::Base, I strongly recommend use begin rescue clauses implicit.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
</pre></td><td class="code"><pre><code class=""><span class="line">class Hoge
</span><span class="line">  def self.exec
</span><span class="line">    raise "something is not good" if something_check
</span><span class="line">
</span><span class="line">    begin
</span><span class="line">      ActiveRecord::Base.transaction do
</span><span class="line">        User.create(username:"moge")
</span><span class="line">        User.create(username:"moge")
</span><span class="line">      end
</span><span class="line">
</span><span class="line">      rescue StandardError =&gt; e
</span><span class="line">        # if database transaction has occured, this statements will be called
</span><span class="line">        p "duplicate error"
</span><span class="line">      end
</span><span class="line">    end
</span><span class="line">
</span><span class="line">  end</span></code></pre></td></tr></table></div></figure></notextile></div>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-11-08T13:04:14+09:00" pubdate data-updated="true">Nov 8<span>th</span>, 2015</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rails/'>rails</a>, <a class='category' href='/blog/categories/rspec/'>rspec</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/09/27/ruboty/">
		
			Ruboty を Github Private で動かす</a>
	</h2>
	<div class="entry-content">
		<h2 id="section">何箇所かハマったので記録しておく</h2>
<p><a href="http://kentana20.hatenablog.com/entry/2014/11/02/180812">http://kentana20.hatenablog.com/entry/2014/11/02/180812</a></p>

<p>基本的には上記の記事にそって行けば大丈夫なんだけど、なんかしょかハマった。<br />
具体的には、readme の deploy ボタンで連携できないことだ。<br />
ただ、問題なく連携はできる。<br />
heroku の deploy タブ の Github のところから private に clone した(fork は不可なので)やつを<br />
指定すれば連携ができる。<br />
あと、dotenv の設定が必要なので、環境変数の設定のために</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">heroku config:add SLACK_PASSWORD='' SLACK_ROOM="" SLACK_TEAM="" SLACK_USERNAME=""</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>というような感じで設定する。  </p>

<p>あと、Add ons で Redis to go を検索して追加する。この時カードを登録してなければ、クレカ登録が促されるので、がんばる。  </p>

<p>password の部分は xmpp の slack パスワードを使うことに注意する(https://xxx.slack.com/account/gateways) 。  </p>

<p><code>bundle exec ruboty</code> を起動させるところ(heroku の resources free dyno で edit して 変更して保存する)。<br />
fork した ruboty-template が依存している xrc の version が 0.1.4 で、  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
</pre></td><td class="code"><pre><code class=""><span class="line">from /app/vendor/ruby-2.0.0/lib/ruby/2.0.0/rexml/parent.rb:41:in `each'
</span><span class="line">p/vendor/bundle/ruby/2.0.0/gems/xrc-0.1.4/lib/xrc/client.rb:249:in `block in on_features_received': undefined method `name' for "   ":REXML::Text (NoMethodError)
</span><span class="line">from /app/vendor/ruby-2.0.0/lib/ruby/2.0.0/rexml/parent.rb:41:in `each'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/xrc-0.1.4/lib/xrc/client.rb:247:in `on_features_received'
</span><span class="line">from /app/vendor/ruby-2.0.0/lib/ruby/2.0.0/rexml/parsers/sax2parser.rb:142:in `call'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/xrc-0.1.4/lib/xrc/client.rb:176:in `on_received'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/xrc-0.1.4/lib/xrc/client.rb:217:in `block in connection'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/xrc-0.1.4/lib/xrc/parser.rb:78:in `call'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/xrc-0.1.4/lib/xrc/parser.rb:78:in `consume'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/xrc-0.1.4/lib/xrc/parser.rb:49:in `end_element'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/xrc-0.1.4/lib/xrc/parser.rb:26:in `block (2 levels) in bind'
</span><span class="line">from /app/vendor/ruby-2.0.0/lib/ruby/2.0.0/rexml/parsers/sax2parser.rb:142:in `block in parse'
</span><span class="line">from /app/vendor/ruby-2.0.0/lib/ruby/2.0.0/rexml/parsers/sax2parser.rb:142:in `parse'
</span><span class="line">from /app/vendor/ruby-2.0.0/lib/ruby/2.0.0/rexml/parsers/sax2parser.rb:142:in `each'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/xrc-0.1.4/lib/xrc/connection.rb:38:in `parse'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/xrc-0.1.4/lib/xrc/connection.rb:34:in `start'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/xrc-0.1.4/lib/xrc/connection.rb:14:in `connect'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/ruboty-1.0.4/lib/ruboty/robot.rb:45:in `adapt'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/xrc-0.1.4/lib/xrc/client.rb:24:in `connect'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/ruboty-slack-0.1.7/lib/ruboty/adapters/slack.rb:81:in `connect'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/ruboty-slack-0.1.7/lib/ruboty/adapters/slack.rb:14:in `run'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/ruboty-1.0.4/lib/ruboty/robot.rb:22:in `run'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/ruboty-1.0.4/bin/ruboty:6:in `&lt;top (required)&gt;'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/gems/ruboty-1.0.4/lib/ruboty/commands/run.rb:5:in `call'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/bin/ruboty:23:in `load'
</span><span class="line">from /app/vendor/bundle/ruby/2.0.0/bin/ruboty:23:in `&lt;main&gt;'</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>こんな感じのエラーがでたので、 xrc のバージョンが古いっぽかったので<br />
Gemfile.lock の version を 0.1.8 に編集して commit したらいけた。  </p>

<p>以上。</p>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-09-27T00:00:00+09:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/ruboty/'>ruboty</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/07/14/update_attribute_trap/">
		
			model.update_attribute の罠</a>
	</h2>
	<div class="entry-content">
		<h2 id="section">背景</h2>
<p>update_attribute で一つだけupdate しようと思ってたら他の属性も変わってて意味不明だった。  </p>

<h2 id="section-1">ヌワー</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class=""><span class="line">user = User.first
</span><span class="line">p user.name  ## "vimtaku"
</span><span class="line">
</span><span class="line">user.name = "hoge"
</span><span class="line">user.update_attribute(:age, 100)
</span><span class="line">##  UPDATE users SET `name` = 'hoge', `age` = 100 where `id` = 1
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>結局 user.reload した。</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-07-14T00:00:00+09:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	
</div>
</article>

<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2017

    vimtaku

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->




	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-30103097-2']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>