---
layout: post
title: "fig(docker compose) で rails する"
description: "fig(docker compose) で rails する"
category: "docker"
tags: [fig docker rails]
---

# メモ

ちなみに、 現在では、 fig は  [docker-compose](https://github.com/docker/compose) になっている。  
が、それに気づかず しばらく fig で進めた。  

fig で rails は tutorial 通りでは動かなかった。  
基本は tutorial にそってやったが、boot2docker 経由でやる場合に、  
binding のあたりで、container 内からは呼べるけど、 boot2docker の中から呼べなくて、  
その辺を修正した。  
ちなみに、 postgresql がサンプルになっていたが、 mysql でやりたかったので適宜変更した。  



### fig.yml

```
db:
  image: mysql:5.6
  ports:
    - "3306:3306"
  environment:
    - MYSQL_ROOT_PASSWORD=hogehoge

web:
  build: .
  command: bundle exec rails server --port=3000 --binding=0.0.0.0
  volumes:
    - .:/myapp
  ports:
    - "3000:3000"
  links:
    - db
```

`fig run web rake db:create db:migrate`

なぜか mysql に繋げなくなるパターンがあったが、  
docker images でだした image を docker rmi で全て消してやり直したり、  
それでも微妙だったので、 fig run db mysqld  とかするといい感じになった。  

# 所感
fig でやれたらよかったと思ったので、ちょっと時間がかかったけど、うまくできそうでよかった(小並感)

